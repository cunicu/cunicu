syntax = "proto3";

package cunicu.core;
option go_package = "github.com/stv0g/cunicu/pkg/proto/core";

import "common.proto";
import "feature/epdisc.proto";

enum ReachabilityType {
    REACHABILITY_TYPE_UNSPECIFIED = 0;
	REACHABILITY_TYPE_UNKNOWN = 1;
	REACHABILITY_TYPE_NONE = 2;
	REACHABILITY_TYPE_DIRECT = 3;
	REACHABILITY_TYPE_RELAYED = 4;
	REACHABILITY_TYPE_RELAYED_BIDIR = 5;
	REACHABILITY_TYPE_ROUTED = 6;
}

message Peer {
    string name = 1;

    // Public WireGuard X25519 key
    bytes public_key = 2;
    bytes preshared_key = 3;

    // List of allowed IPs
    repeated string allowed_ips = 4;

    uint32 persistent_keepalive_interval = 5;

    // Timestamps
    Timestamp last_handshake_timestamp = 6;
    Timestamp last_receive_timestamp = 7;
    Timestamp last_transmit_timestamp = 8;

    // Trafic counters
    int64 transmit_bytes = 9;
    int64 receive_bytes = 10;

    // WireGuard endpoint address
    string endpoint = 11;

    // WireGuard protocol version
    uint32 protocol_version = 12;

    epdisc.Peer ice = 13;

    ReachabilityType reachability = 14;
}
